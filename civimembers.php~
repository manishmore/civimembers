<?php

  /*
   Plugin Name: Civicrm Code Generator for civimembers or events 
   Description: Civicrm Members Or Events
   program in a random language.
   Version: 0.1
   Author: manish
   Author URI: example.com
  */

  /*
  *
  *
  */
$helloworld_table_name = "helloworldsnippets";


global $helloworld_table_name;

  $helloworld_table_name = "helloworldsnippets";

  $mi_table_name = "civicrm_participant";

  $parti_table_email = "civicrm_email";
  
  $mi_table_events = "civicrm_event";

  /*
  * connecting civicrm database
  * author@manish
  */
    $user = "newconnwp";

   $pass = "TI4gyQzw0HLS";

   $db = "newconnwp";

   $host = "localhost";

   $lwpdb = new wpdb( $user, $pass, $db, $host );


function civimembers_install() {

   global $wpdb, $helloworld_table_name;

   return ;
 } 

  register_activation_hook(__FILE__, 'civimembers_install');

function civimembers_uninstall() {

  global $wpdb, $helloworld_table_name;
  
  $table_name = $wpdb->prefix . $helloworld_table_name;

  $drop_sql = "DROP TABLE IF EXISTS ".$table_name;

  $wpdb->query($drop_sql);

}

register_deactivation_hook(__FILE__, 'civimembers_uninstall');


function civimembers_get_civicrm_members( $id ) {
	
    global $lwpdb ,$mi_table_name,$parti_table_email,$mi_table_events;
    
    require_once "wp-content/plugins/civicrm/civicrm.settings.php";
    
    require_once 'CRM/Core/Config.php';

    $config = CRM_Core_Config::singleton();
    
    $sql = "select id, description from ".$mi_table_events ." where id =".$id['id'];
              
    /*
    id, description
    */
   
    $results = $lwpdb->get_results( $sql, ARRAY_A );
   
   //var_dump($results);

   foreach($results as $key => $events)
     {
   
       echo $events['description'];
    
     }
     	return $code;
   }

  /*

   [civievents id="your Event id"]
   call back function for add_shortcode 

  */

  add_shortcode('civievents','civimembers_get_civicrm_members');

  ?>